<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <title>Serving</title>
  </head>
  <body class="bg-green-300">
    <h1 class="text-center text-bold font-50">Serve</h1>

    {% for key, data in grouped_orders.items() %}
    <div class="border border-gray-300 rounded-lg shadow-lg p-4 bg-white">
      {% if data.table_id is not none %}
      <p class="text-lg font-bold text-center">Table {{ data.table_id }}</p>
      {% else %}
      <p class="text-lg font-bold text-center">Takeaway</p>
      {% endif %}
      <p class="text-sm text-gray-500 text-center">
        Order Time: {{ data.order_time }}
      </p>
      <div class="m-4">
        {%for i in data.orders%}
        <p>{{menu[i.menu_id-1]["nameFood"]}}</p>
        <p>{{i.quantity}} จาน - {{i.option}} -{{i.note}}</p>
        {%endfor%}
        <button
          data-order-id="{{ key }}"
          class="btn send-order mt-2 bg-blue-500 text-white px-4 py-2 rounded-lg"
        >
          Send Order
        </button>
      </div>
    </div>
    {% endfor %}

    <script>
      $(document).ready(function () {
        $(".send-order").click(function () {
          var orderId = $(this).data("order-id");
          console.log(orderId);
          $.post({
            url: "/admin/serve",
            data: JSON.stringify({
              id: orderId,
            }),
            contentType: "application/json",
            success: function (response) {
              console.log("✅ Order sent successfully:", response);
            },
            error: function (xhr, status, error) {
              console.error("❌ Error sending order:", error);
            },
          });
        });
      });
    </script>
  </body>
</html>
