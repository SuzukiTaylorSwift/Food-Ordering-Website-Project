<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <title>Edit Menu</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/addmenu.css') }}" />
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  </head>
  <body>
    <div class="table-title">
      <a href="/images"><i class="bx bx-chevrons-left bx-md"></i> </a>
      <h2>EDIT MENU</h2>
      <a href="/admin/login" class="logout-button">Logout</a>
    </div>

    <div class="flex flex-row items-center justify-start">
      <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}
        <div class="menu-container">
          <div id="uploadButton" class="upload-container" onclick="document.getElementById('imageInput').click();">
              <!-- ตรวจสอบว่ามีภาพเดิมหรือไม่ -->
                {% if menu_item.image_path %}
                <!-- แสดงภาพเดิม -->
                <img id="imagePreview" src="{{ url_for('static', filename=menu_item.image_path[7:]) }}" alt="Image Preview" style="display: block; max-width: 100%; max-height: 100%;" />
              {% else %}
                <!-- หากไม่มีรูปภาพ ให้แสดงป้าย ADD NEW MENU -->
                <label for="imageInput" id="uploadTextContainer">
                    <div class="add-newtext">ADD</div>
                    <div class="add-newtext">NEW</div>
                    <div class="add-newtext">MENU</div>
                </label>
              {% endif %}

              <!-- ฟอร์มอัปโหลดภาพ -->
              {{ form.image(id="imageInput", style="display: none;", onchange="updateImagePreview()") }}
              </div>
        

    
        <div class="right-form">
          <!-- Food Name -->
          <label for="name_food" class="font-semibold text-gray-700">Food Name: {{ form.nameFood(class="form-btn") }}</label>

          <!-- Price -->
          <label for="price" class="font-semibold text-gray-700 cursor-pointer" >Price: {{ form.price(class="form-btn") }} </label>
      
          <!-- Food Type -->
          <label for="type" class="font-semibold text-gray-700 cursor-pointer">Food Type:  {{ form.type() }}</label>
      
          <!-- Food Option -->
          <p class="font-semibold text-gray-700 cursor-pointer">Food Option:</p>
          {% for subfield in form.options %}
          <div class="form-check ml-[-100px]">
            {{ subfield() }} <!-- checkbox -->
            <label class="form-check-label">{{ subfield.label.text }}</label> <!-- ข้อความ -->
          </div>
          {% endfor %}

          <!-- Upload Button -->
          <button class="btn bg-blue-500 text-white px-4 py-2 rounded-md mt-4 hover:bg-blue-600 transition" type="submit">
            Save Changes
          </button>
        </div>
      </form>
    </div>

    <script>
      function updateImagePreview() {
        var inputFile = document.getElementById('imageInput');
        var imagePreview = document.getElementById('imagePreview');
        var uploadTextContainer = document.getElementById('uploadTextContainer');
        
        uploadButton.style.backgroundColor = '#f5f5f5';
    
        if (inputFile.files && inputFile.files.length > 0) {
          var reader = new FileReader();
    
          reader.onload = function(event) {
            imagePreview.src = event.target.result;
            imagePreview.style.display = "block";  // แสดงรูป
            uploadTextContainer.style.display = "none";  // ซ่อนข้อความ
          };
    
          reader.readAsDataURL(inputFile.files[0]);  // อ่านไฟล์ภาพ
        }
      }
    </script>
  </body>
</html>