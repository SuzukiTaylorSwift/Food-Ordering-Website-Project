<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khow Ban Chan : Table {{ table_number }}</title>

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">

    <!-- Animate CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link rel="stylesheet" href="/static/css/client_page/table.css">

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>

  <body>

    <h1 class="text-left text-xl">
      khow ban chan : table {{table_number}}
    </h1>
    <div class="hidden" id="tableNum">{{table_number}}</div>
    <div id="confirm"></div>

    <div class="container-xxl position-relative p-0">
      <nav class="navbar navbar-expand-lg px-4 px-lg-5 py-3 py-lg-0">
        <!-- ปุ่มค้นหา -->
        <button id="searchToggle" class="btn btn-outline-primary mr-3">
          <i class="fa fa-search"></i> ค้นหา
        </button>
    
        <!-- แถบเมนูเลื่อนซ้ายขวา 1 แถว -->
        <div class="d-flex flex-nowrap overflow-auto py-2 px-3 nav-tabs">
          <a href="#" class="nav-link tab-link active">Main</a>
          <a href="#" class="nav-link tab-link">Drinks</a>
          <a href="#" class="nav-link tab-link">Appetizer</a>
          <a href="#" class="nav-link tab-link">Vegetarian</a>
          <a href="#" class="nav-link tab-link">Healthy</a>
        </div>
      </nav>
    </div>
    
    <!-- แท็บค้นหา -->
    <div id="searchTab" class="hidden p-4 bg-white shadow-lg rounded-lg">
      <input type="text" id="menuSearch" class="form-control mb-3" placeholder="ค้นหาชื่อเมนู...">
      <div id="menuResults" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </div>

    <!-- แทบเลือกหมวดหมู่อาหาร -->
    <!-- <nav class="bg-gray-100 p-4 rounded-lg shadow-md">
      <ul class="flex space-x-4 justify-center">
          <li class="cursor-pointer px-4 py-2 bg-white rounded-md shadow-sm hover:bg-gray-200">ทั้งหมด</li>
          <li class="cursor-pointer px-4 py-2 bg-white rounded-md shadow-sm hover:bg-gray-200">อาหารคาว</li>
          <li class="cursor-pointer px-4 py-2 bg-white rounded-md shadow-sm hover:bg-gray-200">อาหารหวาน</li>
          <li class="cursor-pointer px-4 py-2 bg-white rounded-md shadow-sm hover:bg-gray-200">เครื่องดื่ม</li>
      </ul>
    </nav> -->

    <div class="food">
      <h2 class="text-left text-xl">
        Main
      </h2>

      <div class="menu-container">
        {% for item in menus %}
          {% if item.type == 'food' %}
          <div class="menu-item">
            <img src="{{ url_for('static', filename=item.image_path.split('static/')[-1]) }}" class="menu-image" alt="Food Image">
            <div class="menu-info">
              <p class="menu-title">{{ item.nameFood }}</p>
              <p class="menu-description">{{ item.description }}</p>
              <p class="menu-price">฿{{ item.price }}</p>
            </div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="drink">
      <h2 class="text-left text-xl">
        Drinks
      </h2>

      <div class="menu-container">
        {% for item in menus %}
          {% if item.type == 'drink' %}
          <div class="menu-item">
            <img src="{{ url_for('static', filename=item.image_path.split('static/')[-1]) }}" class="menu-image" alt="Food Image">
            <div class="menu-info">
              <p class="menu-title">{{ item.nameFood }}</p>
              <p class="menu-description">{{ item.description }}</p>
              <p class="menu-price">฿{{ item.price }}</p>
            </div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="appetizer">
      <h2 class="text-left text-xl">
        Appetizer
      </h2>

      <div class="menu-container">
        {% for item in menus %}
          {% if item.type == 'appetizer' %}
          <div class="menu-item">
            <img src="{{ url_for('static', filename=item.image_path.split('static/')[-1]) }}" class="menu-image" alt="Food Image">
            <div class="menu-info">
              <p class="menu-title">{{ item.nameFood }}</p>
              <p class="menu-description">{{ item.description }}</p>
              <p class="menu-price">฿{{ item.price }}</p>
            </div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
   

    
    <!-- Bootstrap 5 -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


    <script>
      // Example: Set table_id dynamically
      var addCart = [];
      var nameFood = "";
      var count = 0;
      var price = 0;
      var table_number = 0;

      function getData(data) {
        addCart = data[0];
        //console.log(addCart);
      }

      $(document).ready(function () {
        $.getJSON("table/data", getData);

        //console.log($("#tableNum").text());
        table_number = $("#tableNum").text();
        //console.log(table_number);
        $("#id1").click(function () {
          shop();

          //cart.push([])
        });
      });


      $(document).ready(function () {
        $.getJSON("table/data", getData);
      });

      function shop() {
        nameFood = addCart.nameFood;
        price = addCart.price;
        type = addCart.type;
        html = `<div class="bg-white shadow-lg rounded-lg p-6 w-72 text-center">
          <h2 class="text-xl font-semibold text-gray-800">${addCart.nameFood}</h2>
          <p class="text-lg text-gray-500 mt-2">price: ${addCart.price} บาท</p>
          <p class="text-sm text-gray-400 mt-1">type: ${addCart.type}</p>
          <button id="hereEYE"class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
              เพิ่มลงตะกร้า
          </button>
      </div>`;
        $("#confirm").after(html);
      }

      $(document).on("click", "#hereEYE", function () {
        let menu_ids = 0; // เทส
        let orderData = {
          time: "",
          table_id: 0,
          menu_id: [],
          quantity: [],
          total_price: [],
          option: [],
          note: [],
        };
        menu_ids++; // ตั้งเล่นๆเทสระบบ
        orderData.time = new Date().toLocaleString();
        orderData.table_id = table_number;
        orderData.menu_id.push(menu_ids);
        orderData.quantity.push(menu_ids);
        orderData.total_price.push(2000);
        orderData.option.push("อายข้าวผัดแหนม พิเศษ");
        orderData.note.push("ขอแหนมเยอะๆ");
        //
        orderData.menu_id.push(2);
        orderData.quantity.push(5);
        orderData.total_price.push(5000);
        orderData.option.push("พิเศษ");
        orderData.note.push("ไม่เอาผัก");
        console.log(orderData);
        $.post({
          url: "/table" + table_number,
          data: JSON.stringify(orderData),
          contentType: "application/json",
          success: function (response) {
            console.log("Response:", response);
          },
        });
      });


      document.querySelectorAll('.tab-link').forEach(link => {
        link.addEventListener('click', function (event) {
          event.preventDefault();
          // ลบ active จากทุกลิงก์
          document.querySelectorAll('.tab-link').forEach(tab => tab.classList.remove('active'));
          // เพิ่ม active ให้ลิงก์ที่ถูกคลิก
          this.classList.add('active');
        });
      });


      document.getElementById('menuSearch').addEventListener('input', function () {
        const searchText = this.value.toLowerCase();
        document.querySelectorAll('.menu-item').forEach(item => {
          const title = item.querySelector('.menu-title').textContent.toLowerCase();
          if (title.includes(searchText)) {
            item.style.display = '';
          } else {
            item.style.display = 'none';
          }
        });
      });

    </script>
  </body>
</html>
